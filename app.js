
var dataObject = [{
    "id": "272822514",
    "firstName": "Billy",
    "lastName": "Bob",
    "gender": "male",
    "dob": "1/18/1949",
    "height": 71,
    "weight": 175,
    "eyeColor": "brown",
    "occupation": "programmer",
    "parents": [],
    "currentSpouse": "401222887",
}, {
    "id": "401222887",
    "firstName": "Uma",
    "lastName": "Bob",
    "gender": "female",
    "dob": "4/1/1947",
    "height": 65,
    "weight": 162,
    "eyeColor": "brown",
    "occupation": "assistant",
    "parents": [],
    "currentSpouse": "272822514",
}, {
    "id": "409574486",
    "firstName": "Michael",
    "lastName": "Walkens",
    "gender": "male",
    "dob": "5/9/1951",
    "height": 76,
    "weight": 250,
    "eyeColor": "brown",
    "occupation": "landscaper",
    "parents": [],
    "currentSpouse": 260451248
}, {
    "id": "260451248",
    "firstName": "Jon",
    "lastName": "Walkens",
    "gender": "male",
    "dob": "9/6/1945",
    "height": 62,
    "weight": 115,
    "eyeColor": "brown",
    "occupation": "assistant",
    "parents": [],
    "currentSpouse": 409574486
}, {
    "id": "629807187",
    "firstName": "Jack",
    "lastName": "Pafoy",
    "gender": "male",
    "dob": "3/16/1938",
    "height": 70,
    "weight": 207,
    "eyeColor": "black",
    "occupation": "nurse",
    "parents": [],
    "currentSpouse": 464142841
}, {
    "id": "464142841",
    "firstName": "Jen",
    "lastName": "Pafoy",
    "gender": "female",
    "dob": "4/10/1940",
    "height": 72,
    "weight": 256,
    "eyeColor": "black",
    "occupation": "student",
    "parents": [],
    "currentSpouse": 629807187
}, {
    "id": "982411429",
    "firstName": "Mister",
    "lastName": "Potatoo",
    "gender": "male",
    "dob": "12/18/1952",
    "height": 66,
    "weight": 170,
    "eyeColor": "hazel",
    "occupation": "architect",
    "parents": [],
    "currentSpouse": 595767575
}, {
    "id": "595767575",
    "firstName": "Missuz",
    "lastName": "Potatoo",
    "gender": "female",
    "dob": "10/28/1948",
    "height": 59,
    "weight": 137,
    "eyeColor": "blue",
    "occupation": "architect",
    "parents": [],
    "currentSpouse": 982411429
}, {
    "id": "693243224",
    "firstName": "Joy",
    "lastName": "Madden",
    "gender": "female",
    "dob": "4/20/1939",
    "height": 69,
    "weight": 199,
    "eyeColor": "hazel",
    "occupation": "doctor",
    "parents": [],
    "currentSpouse": 693243224
}, {
    "id": "888201200",
    "firstName": "Mader",
    "lastName": "Madden",
    "gender": "male",
    "dob": "5/6/1937",
    "height": 76,
    "weight": 205,
    "eyeColor": "black",
    "occupation": "landscaper",
    "parents": [],
    "currentSpouse": 888201200
}, {
    "id": "878013758",
    "firstName": "Jill",
    "lastName": "Pafoy",
    "gender": "Bob",
    "dob": "2/8/1972",
    "height": 74,
    "weight": 118,
    "eyeColor": "brown",
    "occupation": "programmer",
    "parents": [401222887, 401222887],
    "currentSpouse": 294874671
}, {
    "id": "951747547",
    "firstName": "Ralph",
    "lastName": "Bob",
    "gender": "male",
    "dob": "12/23/1969",
    "height": 66,
    "weight": 179,
    "eyeColor": "blue",
    "occupation": "nurse",
    "parents": [401222887, 401222887],
    "currentSpouse": 159819275
}, {
    "id": "159819275",
    "firstName": "Jasmine",
    "lastName": "Bob",
    "gender": "female",
    "dob": "12/18/1969",
    "height": 58,
    "weight": 156,
    "eyeColor": "blue",
    "occupation": "assistant",
    "parents": [409574486, 260451248],
    "currentSpouse": 951747547
}, {
    "id": "348457184",
    "firstName": "Annie",
    "lastName": "Pafoy",
    "gender": "female",
    "dob": "11/4/1970",
    "height": 62,
    "weight": 235,
    "eyeColor": "hazel",
    "occupation": "landscaper",
    "parents": [629807187, 464142841],
    "currentSpouse": null
}, {
    "id": "294874671",
    "firstName": "Dave",
    "lastName": "Pafoy",
    "gender": "male",
    "dob": "8/5/1967",
    "height": 61,
    "weight": 112,
    "eyeColor": "green",
    "occupation": "doctor",
    "parents": [629807187, 464142841],
    "currentSpouse": 878013758
}, {
    "id": "931247228",
    "firstName": "Amii",
    "lastName": "Pafoy",
    "gender": "female",
    "dob": "3/13/1963",
    "height": 74,
    "weight": 184,
    "eyeColor": "brown",
    "occupation": "landscaper",
    "parents": [629807187, 464142841],
    "currentSpouse": null
}, {
    "id": "822843554",
    "firstName": "Regina",
    "lastName": "Madden",
    "gender": "female",
    "dob": "7/26/1959",
    "height": 71,
    "weight": 249,
    "eyeColor": "brown",
    "occupation": "nurse",
    "parents": [693243224, 888201200],
    "currentSpouse": null
}, {
    "id": "819168108",
    "firstName": "Hana",
    "lastName": "Madden",
    "gender": "female",
    "dob": "10/7/1953",
    "height": 70,
    "weight": 187,
    "eyeColor": "brown",
    "occupation": "politician",
    "parents": [693243224, 888201200],
    "currentSpouse": null
}, {
    "id": "969837479",
    "firstName": "Eloise",
    "lastName": "Madden",
    "gender": "female",
    "dob": "12/11/1961",
    "height": 63,
    "weight": 241,
    "eyeColor": "brown",
    "occupation": "assistant",
    "parents": [693243224, 888201200],
    "currentSpouse": null
}, {
    "id": "313207561",
    "firstName": "Mattias",
    "lastName": "Madden",
    "gender": "male",
    "dob": "2/19/1966",
    "height": 70,
    "weight": 110,
    "eyeColor": "blue",
    "occupation": "assistant",
    "parents": [693243224, 888201200],
    "currentSpouse": 313997561
}, {
    "id": "313997561",
    "firstName": "Ellen",
    "lastName": "Madden",
    "gender": "female",
    "dob": "2/19/1970",
    "height": 67,
    "weight": 100,
    "eyeColor": "blue",
    "occupation": "doctor",
    "parents": [],
    "currentSpouse": 313207561
}, {
    "id": "313998000",
    "firstName": "Joey",
    "lastName": "Madden",
    "gender": "female",
    "dob": "2/02/1987",
    "height": 67,
    "weight": 100,
    "eyeColor": "blue",
    "occupation": "doctor",
    "parents": [313207561, 313997561],
    "currentSpouse": null,
}];

function getFirstNameParam() {
    return document.getElementById("firstName").value;
}

function getLastNameParam() {
    return document.getElementById("lastName").value;
}

function getInfo(firstName, lastName) {
    for (var i = 0; i < dataObject.length; i++) {
        var user = dataObject[i];
        if (user.firstName.toLowerCase() === firstName.toLowerCase() && user.lastName
            .toLowerCase() === lastName.toLowerCase()) {
            console.log(user);
            return user;
        }
    }
    console.log('User not found');
    return null;
}

function getDescendants(personOfInterest) {
    var descendants = [];
    var id = personOfInterest.id;
    for (var i = 0; i < dataObject.length; i++) {
        var user = dataObject[i];
        if (user.parents.indexOf(parseInt(id)) > -1) {
            descendants.push(user);
            var userIdToCheck = user.id;
            var childDescendants = getDescendants(user);
            if (childDescendants) {
                descendants = descendants.concat(childDescendants);
            }
        }
    }
    if(descendants.length === 0){
        return false;
    }
    return descendants;
}

function displayDescendants() {
    return getDescendants(getInfo(getFirstNameParam(), getLastNameParam()));
}

function getParents(personOfInterest) {
    var motherAndFather = [];
    var parentIds = personOfInterest.parents;
    if (parentIds.length == 0) {
        return [];
    }
    var filterCallback = function(user) {
        var id = parseInt(user.id);
        return parentIds.indexOf(id) > -1;
    };
    return dataObject.filter(filterCallback);
}

function getSpouse(personOfInterest) {
    if (personOfInterest.currentSpouse) {
        for (var i = 0; i < dataObject.length; i++) {
            if (personOfInterest.currentSpouse == parseInt(dataObject[i].id)) {
                return dataObject[i];
            }
        }
    }
    return null;
}

function getSiblings(personOfInterest) {
    var filterSiblings = function(user) {
        for (var i = 0; i < user.parents.length; i++) {
            var id = personOfInterest.parents[0];
            if (user.parents.indexOf(id) > -1 && personOfInterest.id !== user.id) {
                return true;
            }
        }
    };
    return dataObject.filter(filterSiblings);
}

function getChildren(personOfInterest) {
        var children = [];
        for (var i = 0; i < dataObject.length; i++) {
            var idToNumber = parseInt(personOfInterest.id);
            var firstParent = dataObject[i].parents[0];
            var lastParent = dataObject[i].parents[1];
            if (idToNumber === firstParent || idToNumber === lastParent) {
                children.push(dataObject[i]);
            }
        }
    return children;
    }
    
function displayFamilyInfo() {
    var family =[];
    var user = getInfo(getFirstNameParam(), getLastNameParam());
    var spouse = getSpouse(user);
    var parents = getParents(user);
    var siblings = getSiblings(user);
    var children = getChildren(user);
    //TODO ensure family member is not null
    // family.push(user);
    if (spouse) {
        family.push(spouse);
    }

    parents.forEach(function (parent) {
        family.push(parent);
    });

    siblings.forEach(function (sibling) {
        family.push(sibling);

    }); 

    children.forEach(function (child) {
        family.push(child)
    });
    console.log(family);
    return family;
}

function getOldestKin(person) {
    var kin = [];
    var spouse = getSpouse(person);
    if (spouse !== null) {
        kin.push(spouse);
    }
    var children = getChildren(person);
    children.forEach(function(child) {
        kin.push(child);
    });
    var parents = getParents(person);
    parents.forEach(function(parent) {
        kin.push(parent);
    });

    var oldest = null;
    if (kin.length > 0) {
        oldest = kin[0];
        for (var i = 0; i < kin.length; i++) {
            var checkedKin = kin[i];
            var oldestBirthday = new Date(oldest.dob);
            var birthday = new Date(checkedKin.dob);
            if (birthday < oldestBirthday) {
                oldest = checkedKin;
                console.log("oldest kin got replaced");
            }
        }
    }
    return oldest;
}

function getOldestKinInfo() {
        var user = getInfo(getFirstNameParam(), getLastNameParam());
        var oldestKin = getOldestKin(user);
        return oldestKin;
    }

function filterCharacteristics(query, everyPerson) {
    var filterResults = everyPerson.filter(function(person){
        if (query.eyeColor!="" && query.eyeColor!=null && person.eyeColor != query.eyeColor){
            return false;
        } 
        if (query.occupation!="" && query.occupation!=null && person.occupation != query.occupation){
            return false;
        }
        if (query.age!="" && query.age!=null && getAge(person) != query.age){
            return false;
        }
        if (query.height!="" && query.height!=null && person.height != query.height){
            return false;
        }
        if (query.weight!="" && query.weight!=null && person.weight != query.weight){
            return false;
        }
    return true;
    });
    return filterResults;
}

function getAge(person) {
    var todayDate = new Date();
    var todayYear = todayDate.getFullYear();
    var todayMonth = todayDate.getMonth();
    var todayDay = todayDate.getDate();
    var dob = person.dob.split("/");
    var birthDay = dob[0];
    var birthMonth = dob[1];
    var birthYear = dob[2];
    age = todayYear - birthYear;

    if(todayMonth < birthMonth -1)
    {
        age--;
    }
    if(birthMonth -1 == todayMonth && todayDay < birthDay)
    {
        age--;
    }
    return age;
}

function getCharacteristicInput() {
    var query = {
        "eyeColor": document.getElementById("eyeColor").value,
        "age": document.getElementById("age").value,
        "height": document.getElementById("height").value,
        "weight": document.getElementById("weight").value,
        "occupation": document.getElementById("occupation").value 
    }
    return query;
}

function getFilterCharacteristics() {
    var characteristicsResults = filterCharacteristics(getCharacteristicInput(),dataObject);
    return characteristicsResults;
    }

function display(output, elementId) {
    document.getElementById(elementId).innerHTML = "<h4>" + "<center>" + "<br>" + "<hr>" + "<br>" + "First Name:" + " " + output.firstName + "<br>" + "<br>" + "Last Name:" + " " + output.lastName + "<br>" + "<br>" + "Gender:" + " " + output.gender + "<br>" + "<br>" + "Date of Birth:" + " " + output.dob +  "<br>" + "<br>" + "Height:" + " " + output.height + "<br>" + "<br>" + "Weight:" + " " + output.weight + "<br>" + "<br>" + "Eye Color:" + " " + output.eyeColor + "<br> " + "<br>" + "<Occupation:>" + " " + output.occupation + "<br>" + "<br>" + "Parents:" + " " + output.parent + "<br>" + "<br>" + "Current Spouse:" + " " + output.currentSpouse + "</center>" + "</h4>";
}


function displayMultiple(outputArray, elementId) {
    var output = "";
    outputArray.forEach(function (user) {
        console.log(user);
        output+= "<h4>" + "<center>" + "<br>" + "<hr>" + "<br>" + "First Name:" + " " + user.firstName + "<br>" + "<br>" + "Last Name:" + " " + user.lastName + "<br>" + "<br>" + "Gender:" + " " + user.gender + "<br>" + "<br>" + "Date of Birth:" + " " + user.dob +  "<br>" + "<br>" + "Height:" + " " + user.height + "<br>" + "<br>" + "Weight:" + " " + user.weight + "<br>" + "<br>" + "Eye Color:" + " " + user.eyeColor + "<br> " + "<br>" + "<Occupation:>" + " " + user.occupation + "<br>" + "<br>" + "Parents:" + " " + user.parent + "<br>" + "<br>" + "Current Spouse:" + " " + user.currentSpouse + "</center>" + "</h4>";
    });
    document.getElementById(elementId).innerHTML = output;
}


